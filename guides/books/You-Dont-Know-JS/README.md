---
title: 《你不知道的JavaScript（上卷）》
---

## 什么是`作用域`

有一套规则（设计良好），这套规则用来找到变量，我们把这套规则称之为 `作用域`

## 简单的作用域链

遍历嵌套作用域链的规则很简单：引擎从当前的执行作用域开始查找变量，如果找不到，就向上一级继续查找。当抵达最外层的全局作用域时，无论找到还是没找到，查找过程都会停止。

## 简单的`编译原理`

>- 对于常见编译型语言（例如：Java）来说，编译步骤分为：词法分析->语法分析->语义检查->代码优化和字节码生成。
>- 对于解释型语言（例如 JavaScript）来说，通过词法分析 -> 语法分析 -> 语法树，就可以开始解释执行了。
>- 词法分析是将字符流(char stream)转换为记号流(token stream)
>- 语法分析成 AST (Abstract Syntax Tree)
>- 预编译，当JavaScript引擎解析脚本时，它会在预编译期对所有声明的变量和函数进行处理！并且是先预声明变量，再预定义函数！
>- 解释执行，在执行过程中，JavaScript 引擎是严格按着作用域机制（scope）来执行的，并且 JavaScript 的变量和函数作用域是在定义时决定的，而不是执行时决定的。JavaScript 中的变量作用域在函数体内有效，无块作用域；
>

关键词 `动态类型` `解释执行` `编译语言`

```sj
var a = 2 ;
```

1. **分词词法分析**字符串拆解为词法单元 ： `var` `a` `=` `2`  **编译器** 编译时处理
2. **解析语法分析**转化为抽象语法树AST
3. **代码生成**生成代码

- 引擎 2

  - 也会问作用域

    - LHS查询 `a=2`
    - RHS查询 获取值  `console.log(a)`

    ```
    
    function foo(a){
    // a=2 // LHS
    console.log(a) // RHS
    }
    
    foo(2) // RHS
    ```

    

- 编译器  1

  - 询问作用域
  - 提供引擎代码

- 作用域

## 词法作用域

词法作用域意味着作用域是由书写代码时函数声明的位置来决定的，JavaScript 中有两个机制可以“欺骗”词法作用域：`eval(..) `和 ``with`。

## 函数作用域

```js
setTimeout(function(){
    
})
```

匿名函数表达式

### 块作用域

## 编译器

```
var a = 2

var a // 编译阶段
a=2 // 执行阶段
```

## 混合对象类

由于类是一种设计模式，所以你可以用一些方法（本章之后会介绍）近似实现类的功能。
为了满足对于类设计模式的最普遍需求，JavaScript 提供了一些近似类的语法

- 这个对象就是类中描述的所有特性的一份副本